<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.aetherit.kfashion.ws.repository.mapper.KfashionImageLocationPolygonMapper">


    <resultMap id="kfashionImageLocationPolygonResultMap" type="KfashionImageLocationPolygon">
        <id property="workNo"                       column="work_no" />
        <result property="workStep"                 column="work_step" />
        <result property="rectNo"                   column="rect_no" />
        <result property="no"                       column="no" />
        <result property="createdDatetime"          column="created_datetime" />
        <result property="updatedDatetime"          column="updated_datetime" />
    </resultMap>

    <insert id="insertLocationPolygon" parameterType="KfashionImageLocationPolygon">
        INSERT
        INTO kfashion_image_location_polygon (
        work_no,
        work_step,
        rect_no,
        no,
        created_datetime,
        updated_datetime
        )VALUES(
        #{workNo},
        #{workStep},
        #{rectNo},
        #{no},
        NOW(),
        NOW()
        )
    </insert>

    <select id="selectPolygonList" resultMap="kfashionImageLocationPolygonResultMap" parameterType="String">
          SELECT DISTINCT
        kfashion_image.work_no,
        kfashion_work.work_name,
        kfashion_work_history.created_id,
        kfashion_work_history.created_datetime
        FROM kfashion_image
        LEFT JOIN kfashion_work_history ON kfashion_image.work_no = kfashion_work_history.work_no
        RIGHT JOIN kfashion_work ON kfashion_image.work_no = kfashion_work.no
        WHERE kfashion_work_history.created_id = #{createdId}
        AND kfashion_work.work_state = 2
        GROUP BY kfashion_image.work_no
    </select>



</mapper>
